<!doctypehtml><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,user-scalable=no"name=viewport><title>PixelPlacer</title><style>*{margin:0;padding:0;box-sizing:border-box}body,html{width:100%;height:100%;overflow:hidden;background:#1a1a1a;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif}#canvas-container{width:100%;height:100%;display:flex;align-items:center;justify-content:center}#canvas{display:block;image-rendering:pixelated;image-rendering:crisp-edges}#loading{position:fixed;top:0;left:0;width:100%;height:100%;background:#1a1a1a;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000;color:#fff}#loading.hidden{display:none}.spinner{width:50px;height:50px;border:3px solid #333;border-top-color:#0af;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px}@keyframes spin{to{transform:rotate(360deg)}}#loading-text{font-size:14px;color:#888}#progress-container{width:200px;height:4px;background:#333;border-radius:2px;margin-top:10px;overflow:hidden}#progress-bar{width:0%;height:100%;background:#0af;transition:width .3s ease}#file-input{display:none}#download-anchor{display:none}</style></head><body><div id=loading><div class=spinner></div><div id=loading-text>Loading PixelPlacer...</div><div id=progress-container><div id=progress-bar></div></div></div><div id=canvas-container><canvas id=canvas tabindex=0></canvas></div><input accept=image/*,.pp id=file-input type=file> <a id=download-anchor></a><script>const canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d",{alpha:!1,willReadFrequently:!1});let wasmReady=!1,currentDpr=window.devicePixelRatio||1;function resizeCanvas(){currentDpr=window.devicePixelRatio||1;const e=window.innerWidth,t=window.innerHeight,n=Math.round(e*currentDpr),a=Math.round(t*currentDpr);canvas.width=n,canvas.height=a,canvas.style.width=e+"px",canvas.style.height=t+"px",wasmReady&&Module._wasm_push_resize_event&&Module._wasm_push_resize_event(n,a)}function getMouseButton(e){switch(e.button){case 0:default:return 1;case 1:return 2;case 2:return 3}}function getModifiers(e){let t=0;return e.shiftKey&&(t|=1),e.ctrlKey&&(t|=2),e.altKey&&(t|=4),e.metaKey&&(t|=8),t}canvas.addEventListener("mousedown",(e=>{if(!wasmReady)return;e.preventDefault(),canvas.focus();const t=Math.round(e.offsetX*currentDpr),n=Math.round(e.offsetY*currentDpr);Module._wasm_push_mouse_event(0,t,n,getMouseButton(e),getModifiers(e))})),canvas.addEventListener("mouseup",(e=>{if(!wasmReady)return;e.preventDefault();const t=Math.round(e.offsetX*currentDpr),n=Math.round(e.offsetY*currentDpr);Module._wasm_push_mouse_event(1,t,n,getMouseButton(e),getModifiers(e))})),canvas.addEventListener("mousemove",(e=>{if(!wasmReady)return;const t=Math.round(e.offsetX*currentDpr),n=Math.round(e.offsetY*currentDpr);Module._wasm_push_mouse_event(2,t,n,0,getModifiers(e))})),canvas.addEventListener("wheel",(e=>{if(!wasmReady)return;e.preventDefault();let t=e.deltaY;1===e.deltaMode?t*=20:2===e.deltaMode&&(t*=100),t=Math.sign(t)*Math.min(Math.abs(t),100);const n=Math.round(e.offsetX*currentDpr),a=Math.round(e.offsetY*currentDpr);Module._wasm_push_wheel_event(n,a,-Math.round(t/10),getModifiers(e))}),{passive:!1}),canvas.addEventListener("contextmenu",(e=>{e.preventDefault()})),canvas.addEventListener("keydown",(e=>{if(!wasmReady)return;if((e.ctrlKey||e.metaKey)&&["r","w","t","n"].includes(e.key.toLowerCase())||e.preventDefault(),Module._wasm_push_key_event(0,e.keyCode,e.code?e.code.charCodeAt(0):0,getModifiers(e),e.repeat?1:0),1===e.key.length&&!e.ctrlKey&&!e.metaKey&&!e.altKey){const t=Module.stringToNewUTF8(e.key);Module._wasm_push_text_input(t),Module._free(t)}})),canvas.addEventListener("keyup",(e=>{wasmReady&&(e.preventDefault(),Module._wasm_push_key_event(1,e.keyCode,e.code?e.code.charCodeAt(0):0,getModifiers(e),0))})),canvas.addEventListener("dragover",(e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy"})),canvas.addEventListener("drop",(async e=>{if(e.preventDefault(),!wasmReady)return;const t=e.dataTransfer.files[0];if(t)try{const e=await t.arrayBuffer(),n=new Uint8Array(e),a=Module._malloc(n.length);HEAPU8.set(n,a);const s=stringToNewUTF8(t.name);Module._wasm_receive_file_data(a,n.length,s),Module._free(s),Module._free(a);const r=stringToNewUTF8(t.name);Module._wasm_push_file_drop(r),Module._free(r)}catch(e){console.error("Drop error:",e)}})),window.addEventListener("resize",resizeCanvas),console.log("Setting up Emscripten Module...");var Module={preRun:[],postRun:[],print:function(e){console.log(e)},printErr:function(e){console.error(e)},canvas:canvas,setStatus:function(e){const t=document.getElementById("loading-text");t&&(t.textContent=e||"Loading...");const n=e.match(/(\d+)\/(\d+)/);if(n){const e=parseInt(n[1])/parseInt(n[2])*100;document.getElementById("progress-bar").style.width=e+"%"}},totalDependencies:0,monitorRunDependencies:function(e){if(this.totalDependencies=Math.max(this.totalDependencies,e),this.totalDependencies>0){const t=(this.totalDependencies-e)/this.totalDependencies*100;document.getElementById("progress-bar").style.width=t+"%"}},onRuntimeInitialized:function(){resizeCanvas(),document.getElementById("loading").classList.add("hidden"),canvas.focus(),wasmReady=!0,console.log("PixelPlacer WASM initialized")}};window.js_render_frame=function(e,t,n){canvas.width===t&&canvas.height===n||(canvas.width=t,canvas.height=n);const a=ctx.createImageData(t,n),s=a.data,r=t*n,o=e+4*r;if(o>HEAPU8.length)console.error("js_render_frame: heap access out of bounds!","pixelPtr:",e,"size:",t,"x",n,"required:",o,"heapSize:",HEAPU8.length);else{for(let t=0;t<r;t++){const n=e+4*t,a=4*t;s[a+0]=HEAPU8[n+3],s[a+1]=HEAPU8[n+2],s[a+2]=HEAPU8[n+1],s[a+3]=HEAPU8[n+0]}ctx.putImageData(a,0,0)}},console.log("Module configured, loading WASM...")</script><script async src=pixelplacer.js></script></body></html>